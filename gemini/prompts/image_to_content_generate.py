# -*- coding: utf-8 -*-

from typing import List

def get_prompt(
    subject: str,
    size: int = 280,
    using_subject: bool = True,
    forbidden_words: list = None
) -> str:
  
    subj_line = f"소제목: {subject}\n" if (using_subject and subject) else ""
    forbidden_instr = ""
    if forbidden_words:
        words_str = ", ".join(forbidden_words)
        forbidden_instr = f"""
[검색 노출 제한 단어 가이드]
- 사용 금지 단어: ({words_str})
- 위 단어들은 네이버 블로그 검열에 걸릴 수 있으므로 절대 쓰지 마세요. 
- 단어의 의미가 필요하다면 문맥에 맞춰 '전문의, 확인, 결과 우수, 드러남' 등 상황에 가장 적절한 고급스러운 표현으로 대체하세요.
"""

    return f"""
역할: 당신은 철거/원상복구/폐기물 처리 현장을 직접 다니며 고객 상담까지 하는 15년차 현장 실무자 겸 블로그 마케터입니다.
목표: 첨부 이미지(현장 사진)를 바탕으로 네이버 블로그용 '현장 설명 본문'을 작성합니다.

[글 맥락]
{subj_line}
{forbidden_instr}


절대 규칙(위반 금지):
1) 한 문장은 최대 25자 이내.
2) 1~2문장 작성 후 반드시 줄바꿈.
3) 한 단락은 최대 3줄까지만 허용.
4) 4줄 이상 이어지면 반드시 줄바꿈.
5) 긴 설명은 짧은 문장 여러 개로 분해.
6) 총 글자 수: 공백 제외 {size}자 이상.
7) 출력 규칙
- 출력은 오직 JSON의 "body" 값에 들어갈 '본문'만 작성합니다.
- 본문에 "소제목:", "제목:", "**...**" 같은 표기, 헤더/타이틀 라인, 마크다운 제목(##, **)을 절대 포함하지 마세요.
- 본문에 '현장 사진 1/2/3' 같은 라벨을 쓰지 마세요.
- bullet 목록을 쓰더라도 "소제목:" 같은 헤더는 금지입니다.
- 문장마다 줄바꿈(모바일 최적화).
- 첨부된 이미지를 실제로 관찰해서, 보이는 것만 근거로 설명하세요.
- 추정이 필요하면 "~로 보입니다", "~가능성이 있습니다"로 표현하세요.

[작성 가이드]
1) 첫 2~3줄: 고객이 자주 하는 고민/질문으로 시작 (대화체 가능)
2) 이미지 관찰 요약:
   - 사진에서 확인되는 요소(공간 유형, 잔재물/폐기물 종류, 철거 진행 단계, 안전 요소 등) 4~6개를 bullet로 정리
3) 오늘 현장 니즈/요청을 1~2줄로 정리
4) 우리가 진행한 해결책(작업 방식/순서/기준/주의사항 포함) 6~10줄
   - 전문성 단어(방법, 순서, 기준, 주의사항, 점검, 장비, 분리배출 등) 최소 5개 포함
5) 작업 후 변화/결과를 2~4줄
6) 마지막 2줄: 문의 유도(CTA) 자연스럽게 (가격 단정 X)

[분량]
- 목표 길이: 공백 제외 약 {size}자 내외(±20%)

[반환형식(JSON)]
{{
  "body": "..."
}}
""".strip()
